!function(){function e(e){s.d("isCloseRegionOnScreen"),s.d("defaultPosition "+P.x+" "+P.y),s.d("offset "+e.offsetX+" "+e.offsetY);var t={};t.x=P.x+e.offsetX,t.y=P.y+e.offsetY,t.width=e.width,t.height=e.height,n("resizeRect",t);var r=e.hasOwnProperty("customClosePosition")?e.customClosePosition:w.customClosePosition;s.d("customClosePosition "+r);var o={width:50,height:50};-1!==r.search("left")?o.x=t.x:-1!==r.search("center")?o.x=t.x+t.width/2-25:-1!==r.search("right")&&(o.x=t.x+t.width-50),-1!==r.search("top")?o.y=t.y:"center"===r?o.y=t.y+t.height/2-25:-1!==r.search("bottom")&&(o.y=t.y+t.height-50);var a={x:0,y:0};return a.width=y.width,a.height=y.height,i(a,o)}function t(e){s.d("fitResizeViewOnScreen"),s.d("defaultPosition "+P.x+" "+P.y),s.d("offset "+e.offsetX+" "+e.offsetY);var t={};t.x=P.x+e.offsetX,t.y=P.y+e.offsetY,t.width=e.width,t.height=e.height,n("resizeRect",t);var r={x:0,y:0};r.width=y.width,r.height=y.height;var o={x:0,y:0};return i(r,t)?(s.d("no adjustment necessary"),o):(t.x<r.x?o.x=r.x-t.x:t.x+t.width>r.x+r.width&&(o.x=r.x+r.width-(t.x+t.width)),s.d("adjustments.x "+o.x),t.y<r.y?o.y=r.y-t.y:t.y+t.height>r.y+r.height&&(o.y=r.y+r.height-(t.y+t.height)),s.d("adjustments.y "+o.y),t.x=P.x+e.offsetX+o.x,t.y=P.y+e.offsetY+o.y,n("adjusted resizeRect",t),o)}function i(e,t){return s.d("isRectContained"),n("containingRect",e),n("containedRect",t),t.x>=e.x&&t.x+t.width<=e.x+e.width&&t.y>=e.y&&t.y+t.height<=e.y+e.height}function n(e,t){s.d(e+" ["+t.x+","+t.y+"],["+(t.x+t.width)+","+(t.y+t.height)+"] ("+t.width+"x"+t.height+")")}var r={};r.log=function(e){if("undefined"!=typeof enableLog){var t=document.createElement("IFRAME");t.setAttribute("src","console-log://"+e),document.documentElement.appendChild(t),t.parentNode.removeChild(t),t=null}},LogLevelEnum={DEBUG:0,INFO:1,WARNING:2,ERROR:3};var o=LogLevelEnum.DEBUG,s={};s.d=function(e){o<=LogLevelEnum.DEBUG&&r.log("(D) "+e)},s.i=function(e){o<=LogLevelEnum.INFO&&r.log("(I) "+e)},s.w=function(e){o<=LogLevelEnum.WARN&&r.log("(W) "+e)},s.e=function(e){r.log("(E) "+e)};var a=window.mraid={},f=a.STATES={LOADING:"loading",DEFAULT:"default",EXPANDED:"expanded",RESIZED:"resized",HIDDEN:"hidden"},d=a.PLACEMENT_TYPES={INLINE:"inline",INTERSTITIAL:"interstitial"},h=a.RESIZE_PROPERTIES_CUSTOM_CLOSE_POSITION={TOP_LEFT:"top-left",TOP_CENTER:"top-center",TOP_RIGHT:"top-right",CENTER:"center",BOTTOM_LEFT:"bottom-left",BOTTOM_CENTER:"bottom-center",BOTTOM_RIGHT:"bottom-right"},u=a.ORIENTATION_PROPERTIES_FORCE_ORIENTATION={PORTRAIT:"portrait",LANDSCAPE:"landscape",NONE:"none"},l=a.EVENTS={ERROR:"error",READY:"ready",SIZECHANGE:"sizeChange",STATECHANGE:"stateChange",VIEWABLECHANGE:"viewableChange"},E=(a.SUPPORTED_FEATURES={SMS:"sms",TEL:"tel",CALENDAR:"calendar",STOREPICTURE:"storePicture",INLINEVIDEO:"inlineVideo"},f.LOADING),c=d.INLINE,g={},m=!1,v=!1,p={width:0,height:0,useCustomClose:!1,isModal:!0},O={allowOrientationChange:!0,forceOrientation:u.NONE},w={width:0,height:0,customClosePosition:h.TOP_RIGHT,offsetX:0,offsetY:0,allowOffscreen:!0},C={x:0,y:0,width:0,height:0},P={x:0,y:0,width:0,height:0},y={width:0,height:0},N={width:0,height:0},S={};a.addEventListener=function(e,t){if(s.i("mraid.addEventListener "+e+": "+String(t)),e&&t)if(T(e,l)){for(var i=S[e]=S[e]||[],n=0;n<i.length;n++){var r=String(t),o=String(i[n]);if(t===i[n]||r===o)return void s.i("listener "+r+" is already registered for event "+e)}i.push(t)}else a.fireErrorEvent("Unknown MRAID event: "+e,"addEventListener");else a.fireErrorEvent("Both event and listener are required.","addEventListener")},a.createCalendarEvent=function(e){s.i("mraid.createCalendarEvent with "+e),x("createCalendarEvent?eventJSON="+JSON.stringify(e))},a.close=function(){s.i("mraid.close"),x("close")},a.expand=function(e){void 0===e?s.i("mraid.expand (1-part)"):s.i("mraid.expand "+e),c!==d.INLINE||E!==f.DEFAULT&&E!==STAES.RESIZED||x(void 0===e?"expand":"expand?url="+encodeURIComponent(e))},a.getCurrentPosition=function(){return s.i("mraid.getCurrentPosition"),C},a.getDefaultPosition=function(){return s.i("mraid.getDefaultPosition"),P},a.getExpandProperties=function(){return s.i("mraid.getExpandProperties"),p},a.getStringExpandProperties=function(){return s.i("mraid.getStringExpandProperties"),JSON.stringify(p)},a.getMaxSize=function(){return s.i("mraid.getMaxSize "+y.width+" x "+y.height),y},a.getStringOrientationProperties=function(){return JSON.stringify(O)},a.getOrientationProperties=function(){return O},a.getPlacementType=function(){return s.i("mraid.getPlacementType"),c},a.getResizeProperties=function(){return s.i("mraid.getResizeProperties"),w},a.getScreenSize=function(){return s.i("mraid.getScreenSize"),N},a.getState=function(){return s.i("mraid.getState"),E},a.getVersion=function(){return s.i("mraid.getVersion"),"2.0"},a.isViewable=function(){return s.i("mraid.isViewable"),m},a.open=function(e){s.i("mraid.open "+e),x("open?url="+encodeURIComponent(e))},a.playVideo=function(e){s.i("mraid.playVideo "+e),x("playVideo?url="+encodeURIComponent(e))},a.removeEventListener=function(e,t){if(s.i("mraid.removeEventListener "+e+" : "+String(t)),e)if(T(e,l))if(S.hasOwnProperty(e))if(t){for(var i=S[e],n=i.length,r=0;r<n;r++){var o=i[r],f=String(t),d=String(o);if(t===o||f===d){i.splice(r,1);break}}r===n&&s.i("listener "+f+" not found for event "+e),0===i.length&&delete S[e]}else delete S[e];else s.i("no listeners registered for event "+e);else a.fireErrorEvent("Unknown MRAID event: "+e,"removeEventListener");else a.fireErrorEvent("Event is required.","removeEventListener")},a.resize=function(){s.i("mraid.resize"),c!==d.INTERSTITIAL&&E!==f.LOADING&&E!==f.HIDDEN&&(E!==f.EXPANDED?v?x("resize"):a.fireErrorEvent("mraid.resize is not ready to be called","mraid.resize"):a.fireErrorEvent("mraid.resize called when ad is in expanded state","mraid.resize"))},a.setExpandProperties=function(e){if(s.i("mraid.setExpandProperties"),I(e,"setExpandProperties")){p.useCustomClose;for(var t=["width","height","useCustomClose"],i=0;i<t.length;i++){var n=t[i];e.hasOwnProperty(n)&&(p[n]=e[n])}}else s.e("failed validation")},a.setOrientationProperties=function(e){if(s.i("mraid.setOrientationProperties"),I(e,"setOrientationProperties")){var t={};t.allowOrientationChange=O.allowOrientationChange,t.forceOrientation=O.forceOrientation;for(var i=["allowOrientationChange","forceOrientation"],n=0;n<i.length;n++){var r=i[n];e.hasOwnProperty(r)&&(t[r]=e[r])}if(t.allowOrientationChange&&t.forceOrientation!==a.ORIENTATION_PROPERTIES_FORCE_ORIENTATION.NONE)a.fireErrorEvent("allowOrientationChange is true but forceOrientation is "+t.forceOrientation,"setOrientationProperties");else{O.allowOrientationChange=t.allowOrientationChange,O.forceOrientation=t.forceOrientation;var o="allowOrientationChange="+O.allowOrientationChange+"&forceOrientation="+O.forceOrientation;x("setOrientationProperties?"+o)}}else s.e("failed validation")},a.setResizeProperties=function(i){s.i("mraid.setResizeProperties"),v=!1;for(var n=["width","height","offsetX","offsetY"],r=0;r<n.length;r++){d=n[r];if(!i.hasOwnProperty(d))return void a.fireErrorEvent("required property "+d+" is missing","mraid.setResizeProperties")}if(I(i,"setResizeProperties")){var o={x:0,y:0};if(i.hasOwnProperty("allowOffscreen")?i.allowOffscreen:w.allowOffscreen){if(!e(i))return void a.fireErrorEvent("close event region will not appear entirely onscreen","mraid.setResizeProperties")}else{if(i.width>y.width||i.height>y.height)return void a.fireErrorEvent("resize width or height is greater than the maxSize width or height","mraid.setResizeProperties");o=t(i)}for(var f=["width","height","offsetX","offsetY","customClosePosition","allowOffscreen"],r=0;r<f.length;r++){var d=f[r];i.hasOwnProperty(d)&&(w[d]=i[d])}var h="width="+w.width+"&height="+w.height+"&offsetX="+(w.offsetX+o.x)+"&offsetY="+(w.offsetY+o.y)+"&customClosePosition="+w.customClosePosition+"&allowOffscreen="+w.allowOffscreen;x("setResizeProperties?"+h),v=!0}else a.fireErrorEvent("failed validation","mraid.setResizeProperties")},a.storePicture=function(e){s.i("mraid.storePicture "+e),x("storePicture?url="+encodeURIComponent(e))},a.supports=function(e){s.i("mraid.supports "+e+" "+g[e]);var t=g[e];return void 0===t&&(t=!1),t},a.useCustomClose=function(e){s.i("mraid.useCustomClose "+e),p.useCustomClose!==e&&(p.useCustomClose=e,x("useCustomClose?useCustomClose="+p.useCustomClose))},a.setCurrentPosition=function(e,t,i,n){s.i("mraid.setCurrentPosition "+e+","+t+","+i+","+n);var r={};r.width=C.width,r.height=C.height,s.i("previousSize "+r.width+","+r.height),C.x=e,C.y=t,C.width=i,C.height=n,i===r.width&&n===r.height||a.fireSizeChangeEvent(i,n)},a.setDefaultPosition=function(e,t,i,n){s.i("mraid.setDefaultPosition "+e+","+t+","+i+","+n),P.x=e,P.y=t,P.width=i,P.height=n},a.setExpandSize=function(e,t){s.i("mraid.setExpandSize "+e+"x"+t),p.width=e,p.height=t},a.setMaxSize=function(e,t){s.i("mraid.setMaxSize "+e+"x"+t),y.width=e,y.height=t},a.setPlacementType=function(e){s.i("mraid.setPlacementType "+e),c=e},a.setScreenSize=function(e,t){s.i("mraid.setScreenSize "+e+"x"+t),N.width=e,N.height=t},a.setSupports=function(e,t){s.i("mraid.setSupports "+e+" "+t),g[e]=t},a.fireErrorEvent=function(e,t){s.i("mraid.fireErrorEvent "+e+" "+t),R(a.EVENTS.ERROR,e,t)},a.fireReadyEvent=function(){s.i("mraid.fireReadyEvent"),R(a.EVENTS.READY)},a.fireSizeChangeEvent=function(e,t){s.i("mraid.fireSizeChangeEvent "+e+"x"+t),R(a.EVENTS.SIZECHANGE,e,t)},a.fireStateChangeEvent=function(e){s.i("mraid.fireStateChangeEvent "+e),E!==e&&(E=e,R(a.EVENTS.STATECHANGE,E))},a.fireViewableChangeEvent=function(e){s.i("mraid.fireViewableChangeEvent "+e),m!==e&&(m=e,R(a.EVENTS.VIEWABLECHANGE,m))};var x=function(e){var t=document.createElement("IFRAME");t.setAttribute("src","mraid://"+e),document.documentElement.appendChild(t),t.parentNode.removeChild(t),t=null},R=function(e){var t=Array.prototype.slice.call(arguments);t.shift(),s.i("fireEvent "+e+" ["+t.toString()+"]");var i={};if(S[e]&&S[e].length)for(var n=0;n<S[e].length;n++)i[r="i"+n]=S[e][n];for(var r in i)i[r].apply(null,t)},T=function(e,t){for(var i in t)if(t[i]===e)return!0;return!1},I=function(e,t){var i=!0,n=A[t];for(var r in e){var o=n[r],s=e[r];o&&!o(s)&&(a.fireErrorEvent("Value of property "+r+" ("+s+") is invalid","mraid."+t),i=!1)}return i},A={setExpandProperties:{width:function(e){return!isNaN(e)},height:function(e){return!isNaN(e)},useCustomClose:function(e){return"boolean"==typeof e}},setOrientationProperties:{allowOrientationChange:function(e){return"boolean"==typeof e},forceOrientation:function(e){return-1!==["portrait","landscape","none"].indexOf(e)}},setResizeProperties:{width:function(e){return!isNaN(e)&&e>=50},height:function(e){return!isNaN(e)&&e>=50},offsetX:function(e){return!isNaN(e)},offsetY:function(e){return!isNaN(e)},customClosePosition:function(e){return-1!==["top-left","top-center","top-right","center","bottom-left","bottom-center","bottom-right"].indexOf(e)},allowOffscreen:function(e){return"boolean"==typeof e}}};a.dumpListeners=function(){var e=Object.keys(S).length;s.i("dumping listeners ("+e+" events)");for(var t in S){var i=S[t];s.i("  "+t+" contains "+i.length+" listeners");for(var n=0;n<i.length;n++)s.i("    "+i[n])}}}();
